daten <- c(daten, Tab$Date)
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
daten
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(list)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
print(Tab)
daten <- c(daten, Tab$Date)
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(list)) {
Tab <- read.csv2(files[i], skip = 4, nrows = 1)
print(Tab[2])
daten <- c(daten, Tab[2])
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
daten
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(list)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
test <- Tab
daten <- c(daten, Tab[2])
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
test
dim(test)
test[1, ]
test[1, 2]
test[1, 1]
test[1, 0]
test[1, 1]
as.date(test[1, 1])
as.Date(test[1, 1])
as.Date(test[1, 1], "dd.mm.YYYY")
as.Date(test[1, 1], "dd.mm.YY")
as.Date(test[1, 1], "%d.%m.%Y")
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(list)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(test[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
daten
daten <- c()
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(list)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(test[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
daten
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(list)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(Tab[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
daten
daten <- c()
daten
for (i in 1:length(list)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(Tab[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
daten
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(files)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(Tab[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
daten
for (i in 1:length(files)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(Tab[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 10, nrows = 2)
eye <- c(eye, Tab[1, 1])
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
eye
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(files)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(Tab[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 10, nrows = 2)
test <- Tab
eye <- c(eye, Tab[1, 1])
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
test
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(files)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(Tab[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 8, nrows = 2)
test <- Tab
eye <- c(eye, Tab[1, 1])
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
test
eye
test[1,]
test[1, 2]
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(files)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(Tab[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 8, nrows = 2)
test <- Tab
eye <- c(eye, as.character(Tab[1, 2]))
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
eye
files <- list.files(".", "*.csv")
Tabelle <- list()
daten <- c()
eye <- c()
for (i in 1:length(files)) {
Tab <- read.csv2(files[i], skip = 3, nrows = 2)
daten <- c(daten, as.Date(Tab[1, 1], "%d.%m.%Y"))
Tab <- read.csv2(files[i], skip = 8, nrows = 2)
test <- Tab
eye <- c(eye, as.character(Tab[1, 2]))
Tab <- read.csv2(files[i], skip = 14, nrows = 71)
Tabelle[i] <- list(Tab[11:71, ])
}
all_data <- c()
for (i in 1:61) {
liste <- c()
for (j in 1:4) {
liste <- c(liste, Tabelle[[j]][i, 7])
}
model <- lm(liste ~ daten)
tab <- data.frame(x = daten,
y = liste,
slope = coef(model)[[2]],
pvalue = pf(summary(model)$fstatistic[1], summary(model)$fstatistic[2],
summary(model)$fstatistic[3], lower.tail = FALSE),
seg = i,
eye = eye)
all_data <- rbind(all_data, tab)
}
warnings()
all_data
pvalues <- tapply(all_data$pvalue, all_data$seg, mean)
slopes <- tapply(all_data$slope, all_data$seg, mean)
plot(c(-6, 6), c(-6, 6))
for(i in 1:61) {
if (pvalues[i] < 0.05) {
result_char = "0"
if (slopes[i] > 0) result_char = "+"
if (slopes[i] < 0) result_char = "-"
} else {
result_char = "."
}
text(gridX[i], gridY[i], result_char)
}
library(ggplot2)
headerPlot <-
header %>%
mutate(condition = factor(condition, levels = header$condition,
labels = c("DA rod", "DA mixed", "osc. pot.", "LA mixed", "flicker")))
library(dplyr)
con <- file("Preller_Markus_20041011_1505.csv", "r")
library(dplyr)
con <- file("/media/cord/943E-3647/ERGs/Preller_Markus_20041011_1505.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
selector <-
sapply(results, function(x) { if (x[1] == "RAW DATA SECTION:") return(T) else return(F)})
selectorTime <- which(selector) - 1
header1 <- do.call("rbind.data.frame", results[selectorTime])
print(header1[1, c(1, 1, 3, 3, 5, 5)])
names(header1) <- unlist(header1[1, c(1, 1, 3, 3, 5, 5)])
header1 <- header1[, c(2, 4, 6)]
print(header1)
selectorExam <- which(selector) + 2
header2 <- c(
lapply(
results[selectorExam], function(x) {
x[2] %>% sub("right ", "", .) %>% sub("R-1", "", .)
}),
recursive = T)
header <-
data.frame(header1, condition = header2, stimulus_offset = c(.02, .02, .02, .02, NA)) %>%
mutate(Dist = as.numeric(as.character(Dist.s.)))
print(header)
library(dplyr)
selectorOD <- rep(which(selector), each = 4) +
rep(c(2, 4, 6, 8), times = length(which(selector)))
selectorOS <- rep(which(selector), each = 4) +
rep(c(3, 5, 7, 9), times = length(which(selector)))
resultsRawOD <- results[selectorOD]
resultsRawOS <- results[selectorOS]
resultsRawOD <-
lapply(resultsRawOD,
function(x) {
data.frame(condition = x[2] %>% sub("right ", "", .) %>% sub("R-1", "", .),
eye = "OD",
t = as.numeric(x[3]) - 1 + 1:128,
value = as.numeric(x[4:131]))
}
)
resultsRawOD <- do.call("rbind.data.frame", resultsRawOD)
resultsRawOS <-
lapply(resultsRawOS,
function(x) {
data.frame(condition = x[2] %>% sub("left ", "", .) %>% sub("L-2", "", .),
eye = "OS",
t = as.numeric(x[3]) - 1 + 1:128,
value = as.numeric(x[4:131]))
}
)
resultsRawOS <- do.call("rbind.data.frame", resultsRawOS)
resultsRaw <- rbind(resultsRawOD, resultsRawOS) %>%
left_join(header %>% select(condition, Dist) %>% mutate) %>%
mutate(time = (t - 1) * Dist,
condition = factor(condition, levels = header$condition,
labels = c("DA rod", "DA mixed", "osc. pot.", "LA mixed", "flicker")),
value = value * 1000000)
tail(resultsRaw)
baseline <-
resultsRaw %>%
filter((condition == "Flicker") | (time < .02)) %>%
group_by(condition, eye) %>%
summarize(baseline = mean(value))
resultsRaw <-
left_join(resultsRaw, baseline) %>%
mutate(value = value - baseline)
head(resultsRaw)
library(ggplot2)
headerPlot <-
header %>%
mutate(condition = factor(condition, levels = header$condition,
labels = c("DA rod", "DA mixed", "osc. pot.", "LA mixed", "flicker")))
rbind(resultsRaw, normalValues) %>%
mutate(eye = as.factor(eye)) %>%
ggplot(aes(x = time, y = value)) +
geom_line() +
geom_vline(aes(xintercept = stimulus_offset), data = headerPlot) +
facet_grid(condition ~ eye, drop = T, scales = "free_y") +
scale_x_continuous("Time [s]", limits = c(.01, .15)) +
opts(panel.grid.minor = theme_blank())
load("~/mfERG/normalERG.Rda")
library(ggplot2)
headerPlot <-
header %>%
mutate(condition = factor(condition, levels = header$condition,
labels = c("DA rod", "DA mixed", "osc. pot.", "LA mixed", "flicker")))
rbind(resultsRaw, normalValues) %>%
mutate(eye = as.factor(eye)) %>%
ggplot(aes(x = time, y = value)) +
geom_line() +
geom_vline(aes(xintercept = stimulus_offset), data = headerPlot) +
facet_grid(condition ~ eye, drop = T, scales = "free_y") +
scale_x_continuous("Time [s]", limits = c(.01, .15)) +
opts(panel.grid.minor = theme_blank())
library(ggplot2)
headerPlot <-
header %>%
mutate(condition = factor(condition, levels = header$condition,
labels = c("DA rod", "DA mixed", "osc. pot.", "LA mixed", "flicker")))
rbind(resultsRaw, normalValues) %>%
mutate(eye = as.factor(eye)) %>%
ggplot(aes(x = time, y = value)) +
geom_line() +
geom_vline(aes(xintercept = stimulus_offset), data = headerPlot) +
facet_grid(condition ~ eye, drop = T, scales = "free_y") +
scale_x_continuous("Time [s]", limits = c(.01, .15)) +
opts(panel.grid.minor = theme_blank()) +
theme_minimal()
library(ggplot2)
headerPlot <-
header %>%
mutate(condition = factor(condition, levels = header$condition,
labels = c("DA rod", "DA mixed", "osc. pot.", "LA mixed", "flicker")))
rbind(resultsRaw, normalValues) %>%
mutate(eye = as.factor(eye)) %>%
ggplot(aes(x = time, y = value)) +
geom_line() +
geom_vline(aes(xintercept = stimulus_offset), data = headerPlot) +
facet_grid(condition ~ eye, drop = T, scales = "free_y") +
scale_x_continuous("Time [s]", limits = c(.01, .15)) +
theme_minimal()
# scale_y_continuous("[?V]", limits = c(-280, 280), breaks = c(-150, 0, 150))
#normalValues <- resultsRaw %>% filter(eye == "OD") %>% mutate(eye = "normal")
#print(normalValues)
#save(normalValues, file = "E:/ERGs/normalERG.Rda")
#ggsave("neuronalCeroidLipofuscinosis.png", width = 5, height = 4.5)
library(ggplot2)
headerPlot <-
header %>%
mutate(condition = factor(condition, levels = header$condition,
labels = c("DA rod", "DA mixed", "osc. pot.", "LA mixed", "flicker")))
rbind(resultsRaw, normalValues) %>%
mutate(eye = as.factor(eye)) %>%
ggplot(aes(x = time, y = value)) +
geom_line() +
geom_vline(aes(xintercept = stimulus_offset), data = headerPlot) +
facet_grid(condition ~ eye, drop = T, scales = "free_y") +
scale_x_continuous("Time [s]", limits = c(.01, .15)) +
theme_void()
# scale_y_continuous("[?V]", limits = c(-280, 280), breaks = c(-150, 0, 150))
#normalValues <- resultsRaw %>% filter(eye == "OD") %>% mutate(eye = "normal")
#print(normalValues)
#save(normalValues, file = "E:/ERGs/normalERG.Rda")
#ggsave("neuronalCeroidLipofuscinosis.png", width = 5, height = 4.5)
library(ggplot2)
headerPlot <-
header %>%
mutate(condition = factor(condition, levels = header$condition,
labels = c("DA rod", "DA mixed", "osc. pot.", "LA mixed", "flicker")))
plotData <-
rbind(resultsRaw, normalValues) %>%
mutate(eye = as.factor(eye))
plot1 <- ggplot(plotData %>% filter(condition %in% c("DA rod", "DA mixed")), aes(x = time, y = value)) +
geom_line() +
geom_vline(aes(xintercept = stimulus_offset), data = headerPlot) +
facet_grid(condition ~ eye, drop = T, scales = "free_y") +
scale_x_continuous("Time [s]", limits = c(.01, .15)) +
theme_void()
# scale_y_continuous("[?V]", limits = c(-280, 280), breaks = c(-150, 0, 150))
print(plot1)
#normalValues <- resultsRaw %>% filter(eye == "OD") %>% mutate(eye = "normal")
#print(normalValues)
#save(normalValues, file = "E:/ERGs/normalERG.Rda")
#ggsave("neuronalCeroidLipofuscinosis.png", width = 5, height = 4.5)
plot1 <- ggplot(plotData %>% filter(condition %in% c("DA rod", "DA mixed")) %>% mutate(condition = factor(condition)), aes(x = time, y = value)) +
geom_line() +
geom_vline(aes(xintercept = stimulus_offset), data = headerPlot) +
facet_grid(condition ~ eye, drop = T, scales = "free_y") +
scale_x_continuous("Time [s]", limits = c(.01, .15)) +
theme_void()
# scale_y_continuous("[?V]", limits = c(-280, 280), breaks = c(-150, 0, 150))
print(plot1)
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
results
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
rbind(results[[1]], results[[2]])
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
rbind(results[[1]], results[[2]])[2:9, 1:2]
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- data.frame(results[[]])
test
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- data.frame(results[[2]])
test
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
test
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
names(test) <- results[[1]]
test
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
names(test) <- results[[1]]
data.frame(test)
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
test2 <- results[[1]]
test2
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
test2 <- results[[1]]
test1
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
test2 <- results[[1]]
test
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
names(test) <- results[[1]]
test
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
names(test) <- results[[1]]
test[1]
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
names(test) <- results[[1]]
test[2]
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
names(test) <- results[[1]]
print("\n")
test[2]
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
names(test) <- results[[1]]
print("\n")
test[1:2]
library(dplyr)
con <- file("20121219_OD_FOK.csv", "r")
resultFile <- readLines(con)
close(con)
results <- strsplit(resultFile, ";")
test <- c(results[[2]])
names(test) <- results[[1]]
print("\n")
test[1:3]
